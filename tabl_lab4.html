<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Таблица студентов</title>
    <link rel="stylesheet" href="tabl.css">
    <style>
    .form-container {
        background: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        margin-bottom: 30px;
    }
    
    .form-row {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 15px;
    }
    
    .form-field {
        flex: 1;
        min-width: 200px;
    }
    
    label {
        display: block;
        margin-bottom: 8px;
        font-weight: bold;
        color: #2c3e50;
    }
    
    input, select {
        width: 100%;
        padding: 12px;
        border: 2px solid #bdc3c7;
        border-radius: 8px;
        font-size: 16px;
        transition: border-color 0.3s ease;
        box-sizing: border-box;
    }
    
    input:focus, select:focus {
        border-color: #3498db;
        outline: none;
        box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
    }
    
    .btn-submit {
        background: linear-gradient(135deg, #27ae60, #2ecc71);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 8px;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 10px;
    }
    
    .btn-submit:hover {
        background: linear-gradient(135deg, #229954, #27ae60);
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
    }
    
    .form-title {
        color: #2c3e50;
        border-bottom: 3px solid #3498db;
        padding-bottom: 10px;
        margin-bottom: 25px;
        font-size: 24px;
    }

    .form-actions {
        display: flex;
        justify-content: center;
        margin-top: 20px;
    }

    .bottom-actions {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 30px;
        padding-top: 20px;
        border-top: 2px solid #ecf0f1;
    }

    .bottom-btn {
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .bottom-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(149, 165, 166, 0.3);
    }

    .clear-btn {
        background: linear-gradient(135deg, #e74c3c, #c0392b);
    }

    .clear-btn:hover {
        background: linear-gradient(135deg, #c0392b, #a93226);
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
    }

    .reset-btn {
        background: linear-gradient(135deg, #f39c12, #e67e22);
    }
</style>
</head>
<body>
    <!-- Шапка -->
    <div class="header">
        <a href="Laba_3.html" class="nav-link">Основная страница</a>
        <a href="page2.html" class="nav-link">Позиционирование элементов</a>
        <a href="tabl.html" class="nav-link">Таблица</a>
    </div>

    <!-- форма для добавки новых студиков -->
    <div class="form-container">
        <h2 class="form-title">Добавить нового студента</h2>
        <form id="studentForm">
            <div class="form-row">
                <div class="form-field">
                    <label for="fullName">ФИО студента:</label>
                    <input type="text" id="fullName" name="fullName" required>
                </div>
                
                <div class="form-field">
                    <label for="group">Номер группы:</label>
                    <select id="group" name="group" required>
                        <option value="">Выберите группу</option>
                        <option value="ИТ-21">ИТ-21</option>
                        <option value="ИТ-22">ИТ-22</option>
                        <option value="ПИ-21">ПИ-21</option>
                        <option value="ПИ-22">ПИ-22</option>
                        <option value="КБ-21">КБ-21</option>
                        <option value="КБ-22">КБ-22</option>
                    </select>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-field">
                    <label for="gender">Пол:</label>
                    <select id="gender" name="gender" required>
                        <option value="">Выберите пол</option>
                        <option value="М">Мужской</option>
                        <option value="Ж">Женский</option>
                    </select>
                </div>
                
                <div class="form-field">
                    <label for="age">Возраст:</label>
                    <input type="number" id="age" name="age" min="16" max="35" required>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-field">
                    <label for="admission">Форма поступления:</label>
                    <select id="admission" name="admission" required>
                        <option value="">Выберите форму</option>
                        <option value="ЕГЭ">ЕГЭ</option>
                        <option value="Олимпиада">Олимпиада</option>
                        <option value="Целевое">Целевое</option>
                    </select>
                </div>
                
                <div class="form-field">
                    <label for="direction">Название направления:</label>
                    <select id="direction" name="direction" required>
                        <option value="">Выберите направление</option>
                        <option value="Информатика и вычислительная техника">Информатика и вычислительная техника</option>
                        <option value="Прикладная информатика">Прикладная информатика</option>
                        <option value="Компьютерная безопасность">Компьютерная безопасность</option>
                        <option value="Программная инженерия">Программная инженерия</option>
                        <option value="Информационные системы и технологии">Информационные системы и технологии</option>
                    </select>
                </div>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="btn-submit">Добавить студента</button>
            </div>
        </form>
    </div>

    <div class="content">
        <table class="students-table" id="studentsTable">
            <caption>Список студентов университета</caption>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>ФИО студента</th>
                    <th>Номер зачётной книжки</th>
                    <th>Номер группы</th>
                    <th>Пол</th>
                    <th>Возраст</th>
                    <th>Форма поступления</th>
                    <th>Название направления</th>
                </tr>
            </thead>
            <tbody>
                <!-- данные заполняются автоматически -->
            </tbody>
        </table>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const tableBody = document.querySelector('#studentsTable tbody');
        const baseRecordNumber = 2023000;

        // ф-ция для получения данных из localStorage
        function getStudentsData() {
            const savedData = localStorage.getItem('studentsData');
            if (savedData) {
                return JSON.parse(savedData);
            } else {
                // начдан, если в localStorage ничего нет
                return [
                    { name: 'Иванов Алексей Петрович', group: 'ИТ-21', gender: 'М', age: 19, admission: 'ЕГЭ', direction: 'Информатика и вычислительная техника' },
                    { name: 'Петрова Мария Сергеевна', group: 'ПИ-21', gender: 'Ж', age: 20, admission: 'Олимпиада', direction: 'Прикладная информатика' },
                    { name: 'Сидоров Дмитрий Иванович', group: 'ИТ-21', gender: 'М', age: 18, admission: 'ЕГЭ', direction: 'Информатика и вычислительная техника' },
                    { name: 'Козлова Анна Владимировна', group: 'ПИ-21', gender: 'Ж', age: 21, admission: 'Целевое', direction: 'Прикладная информатика' },
                    { name: 'Васильев Павел Андреевич', group: 'ИТ-22', gender: 'М', age: 19, admission: 'ЕГЭ', direction: 'Информатика и вычислительная техника' },
                    { name: 'Николаева Екатерина Дмитриевна', group: 'ПИ-22', gender: 'Ж', age: 20, admission: 'Олимпиада', direction: 'Прикладная информатика' },
                    { name: 'Фёдоров Артём Сергеевич', group: 'ИТ-21', gender: 'М', age: 18, admission: 'ЕГЭ', direction: 'Информатика и вычислительная техника' },
                    { name: 'Смирнова Ольга Игоревна', group: 'ПИ-21', gender: 'Ж', age: 22, admission: 'Целевое', direction: 'Прикладная информатика' }
                ];
            }
        }

        // ф-ция для сохран дан в localStorage
        function saveStudentsData(data) {
            localStorage.setItem('studentsData', JSON.stringify(data));
        }

        // загружаем данные
        let studentsData = getStudentsData();

        // ф-ция для отрисовки таблы
        function renderTable() {
            tableBody.innerHTML = '';
            
            studentsData.forEach((student, index) => {
                const row = document.createElement('tr');
                const id = index + 1;
                const recordBook = baseRecordNumber + id;

                row.innerHTML = `
                    <td>${id}</td>
                    <td>${student.name}</td>
                    <td>${recordBook}</td>
                    <td>${student.group}</td>
                    <td>${student.gender}</td>
                    <td>${student.age}</td>
                    <td>${student.admission}</td>
                    <td>${student.direction}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // обработчик формы
        document.getElementById('studentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const newStudent = {
                name: formData.get('fullName'),
                group: formData.get('group'),
                gender: formData.get('gender'),
                age: parseInt(formData.get('age')),
                admission: formData.get('admission'),
                direction: formData.get('direction')
            };
            
            // добав нового студика
            studentsData.push(newStudent);
            
            // сохраняем в localStorage
            saveStudentsData(studentsData);
            
            // перерисовываем таблицу
            renderTable();
            
            // очистка формы
            this.reset();
            
            // показываем сообщение об успехе
            alert('Студент успешно добавлен в таблицу! Данные сохранены.');
        });

        // функция обратного отсчета для уничтожения таблицы
        function startDestructionCountdown() {
            let countdown = 10;
            const originalText = 'Уничтожение таблицы';
            
            // создаем окно для отсчета
            const modal = document.createElement('div');
            modal.style.position = 'fixed';
            modal.style.top = '50%';
            modal.style.left = '50%';
            modal.style.transform = 'translate(-50%, -50%)';
            modal.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
            modal.style.color = 'white';
            modal.style.padding = '30px';
            modal.style.borderRadius = '15px';
            modal.style.boxShadow = '0 10px 30px rgba(0,0,0,0.5)';
            modal.style.zIndex = '1000';
            modal.style.textAlign = 'center';
            modal.style.minWidth = '300px';
            
            const countdownText = document.createElement('div');
            countdownText.style.fontSize = '24px';
            countdownText.style.fontWeight = 'bold';
            countdownText.style.marginBottom = '20px';
            countdownText.textContent = `Уничтожение через: ${countdown}`;
            
            const warningText = document.createElement('div');
            warningText.style.fontSize = '16px';
            warningText.style.marginBottom = '20px';
            warningText.textContent = 'Таблица студентов будет полностью очищена!';
            
            const cancelBtn = document.createElement('button');
            cancelBtn.textContent = 'ОТМЕНИТЬ УНИЧТОЖЕНИЕ';
            cancelBtn.style.background = 'white';
            cancelBtn.style.color = '#e74c3c';
            cancelBtn.style.border = 'none';
            cancelBtn.style.padding = '12px 24px';
            cancelBtn.style.borderRadius = '8px';
            cancelBtn.style.fontWeight = 'bold';
            cancelBtn.style.cursor = 'pointer';
            cancelBtn.style.fontSize = '14px';
            cancelBtn.style.transition = 'all 0.3s ease';
            
            cancelBtn.addEventListener('mouseover', function() {
                this.style.background = '#f1f1f1';
                this.style.transform = 'scale(1.05)';
            });
            
            cancelBtn.addEventListener('mouseout', function() {
                this.style.background = 'white';
                this.style.transform = 'scale(1)';
            });
            
            modal.appendChild(countdownText);
            modal.appendChild(warningText);
            modal.appendChild(cancelBtn);
            document.body.appendChild(modal);
            
            // Затемняем фон
            const overlay = document.createElement('div');
            overlay.style.position = 'fixed';
            overlay.style.top = '0';
            overlay.style.left = '0';
            overlay.style.width = '100%';
            overlay.style.height = '100%';
            overlay.style.background = 'rgba(0,0,0,0.7)';
            overlay.style.zIndex = '999';
            document.body.appendChild(overlay);
            
            // запуск отсчета
            const countdownInterval = setInterval(function() {
                countdown--;
                countdownText.textContent = `Уничтожение через: ${countdown}`;
                
                // меняем цвет при приближении к нулю
                if (countdown <= 3) {
                    countdownText.style.color = '#ffeb3b';
                    modal.style.background = 'linear-gradient(135deg, #ff6b6b, #e74c3c)';
                }
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    // выполняем уничтожение
                    studentsData = [];
                    saveStudentsData(studentsData);
                    renderTable();
                    
                    // показываем сообщение об уничтожении
                    countdownText.textContent = 'ТАБЛИЦА УНИЧТОЖЕНА!';
                    countdownText.style.color = '#ffeb3b';
                    countdownText.style.fontSize = '28px';
                    warningText.textContent = 'Все данные студентов удалены';
                    cancelBtn.style.display = 'none';
                    
                    // автоматически закрываем через 2 секунды
                    setTimeout(function() {
                        document.body.removeChild(modal);
                        document.body.removeChild(overlay);
                        alert('Таблица успешно уничтожена!');
                    }, 2000);
                }
            }, 1000);
            
            // обработчик отмены
            cancelBtn.addEventListener('click', function() {
                clearInterval(countdownInterval);
                document.body.removeChild(modal);
                document.body.removeChild(overlay);
                alert('Уничтожение отменено! Таблица спасена!');
            });
            
            // отмена по ESC
            const escapeHandler = function(e) {
                if (e.key === 'Escape') {
                    clearInterval(countdownInterval);
                    document.body.removeChild(modal);
                    document.body.removeChild(overlay);
                    document.removeEventListener('keydown', escapeHandler);
                    alert('Уничтожение отменено! Таблица спасена!');
                }
            };
            
            document.addEventListener('keydown', escapeHandler);
            
            // удаляем обработчик при закрытии модального окна
            modal.addEventListener('DOMNodeRemoved', function() {
                document.removeEventListener('keydown', escapeHandler);
            });
        }

        // кнопки для очистки и сброса внизу страницы
        function addBottomButtons() {
            const bottomActions = document.createElement('div');
            bottomActions.className = 'bottom-actions';
            
            const destroyBtn = document.createElement('button');
            destroyBtn.textContent = 'Уничтожение таблицы';
            destroyBtn.className = 'bottom-btn clear-btn';
            
            const resetBtn = document.createElement('button');
            resetBtn.textContent = 'Сбросить к исходным данным';
            resetBtn.className = 'bottom-btn reset-btn';
            
            destroyBtn.addEventListener('click', function() {
                startDestructionCountdown();
            });
            
            resetBtn.addEventListener('click', function() {
                if (confirm('Вернуть исходные данные? Текущие данные будут потеряны.')) {
                    localStorage.removeItem('studentsData');
                    studentsData = getStudentsData();
                    saveStudentsData(studentsData);
                    renderTable();
                    alert('Данные сброшены к исходным!');
                }
            });
            
            bottomActions.appendChild(destroyBtn);
            bottomActions.appendChild(resetBtn);
            
            document.querySelector('.content').after(bottomActions);
        }

        // первоначальная отрисовка таблицы
        renderTable();
        
        // добавляем кнопки внизу страницы
        addBottomButtons();
    });
    </script>
</body>
</html>